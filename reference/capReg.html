<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Covariate Assisted Principal Regression for Covariance Matrix Outcomes — capReg • cap</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Covariate Assisted Principal Regression for Covariance Matrix Outcomes — capReg" />
<meta property="og:description" content="This function identifies the first \(k\) projection directions that satisfies the log-linear model assumption." />






<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->




  

  

  </head>

  <body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cap</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Covariate Assisted Principal Regression for Covariance Matrix Outcomes</h1>
    
    <div class="hidden name"><code>capReg.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function identifies the first \(k\) projection directions that satisfies the log-linear model assumption.</p>
    </div>

    <div class="ref-usage sourceCode"><pre class='sourceCode r'><code><span class='fu'>capReg</span><span class='op'>(</span><span class='va'>Y</span>, <span class='va'>X</span>, nD <span class='op'>=</span> <span class='fl'>1</span>, method <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"CAP"</span>, <span class='st'>"CAP-C"</span><span class='op'>)</span>, CAP.OC <span class='op'>=</span> <span class='cn'>FALSE</span>, 
  max.itr <span class='op'>=</span> <span class='fl'>1000</span>, tol <span class='op'>=</span> <span class='fl'>1e-04</span>, trace <span class='op'>=</span> <span class='cn'>FALSE</span>, score.return <span class='op'>=</span> <span class='cn'>TRUE</span>, 
  gamma0.mat <span class='op'>=</span> <span class='cn'>NULL</span>, ninitial <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span></code></pre></div>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>Y</th>
      <td><p>a data list of length \(n\). Each list element is a \(T\times p\) matrix, the data matrix of \(T\) observations from \(p\) features.</p></td>
    </tr>
    <tr>
      <th>X</th>
      <td><p>a \(n\times q\) data matrix, the covariate matrix of \(n\) subjects with \(q-1\) predictors. The first column is all ones.</p></td>
    </tr>
    <tr>
      <th>nD</th>
      <td><p>an integer, the number of directions to be identified. Default is 1.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>a character of optimization method. <code>method = "CAP"</code> considers a weighted L2-norm on the \(\gamma\) vector and solve for the optimizer by block coordinated descent; <code>method = "CAP-C"</code> assumes the complete common principal component assumption which identifies the common principal component first and then searches for the optimal PC.</p></td>
    </tr>
    <tr>
      <th>CAP.OC</th>
      <td><p>a logic variable. Whether the orthogonal constraint is imposed when identifying higher-order PCs. When <code>method = "CAP-C"</code>, this is ignored. Default is <code>FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>max.itr</th>
      <td><p>an integer, the maximum number of iterations.</p></td>
    </tr>
    <tr>
      <th>tol</th>
      <td><p>a numeric value of convergence tolerance.</p></td>
    </tr>
    <tr>
      <th>trace</th>
      <td><p>a logic variable. Whether the solution path is reported. Default is <code>FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>score.return</th>
      <td><p>a logic variable. Whether the log-variance in the transformed space is reported. Default is <code>TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>gamma0.mat</th>
      <td><p>a data matrix, the initial value of \(\gamma\). Default is <code>NULL</code>, and initial value is randomly chosen.</p></td>
    </tr>
    <tr>
      <th>ninitial</th>
      <td><p>an integer, the number of different initial value is tested. When it is greater than 1, multiple initial values will be tested, and the one yields the minimum objective function will be reported. Default is <code>NULL</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Considering \(y_{it}\) are \(p\)-dimensional independent and identically distributed random samples from a multivariate normal distribution with mean zero and covariance matrix \(\Sigma_{i}\). We assume there exits a \(p\)-dimensional vector \(\gamma\) such that \(z_{it}:=\gamma'y_{it}\) satisfies the multiplicative heteroscedasticity:
  $$\log(\mathrm{Var}(z_{it}))=\log(\gamma'\Sigma_{i}\gamma)=\beta_{0}+x_{i}'\beta_{1}$$,
where \(x_{i}\) contains explanatory variables of subject \(i\), and \(\beta_{0}\) and \(\beta_{1}\) are model coefficients.</p>
<p>Parameters \(\gamma\) and \(\beta=(\beta_{0},\beta_{1}')'\) are study of interest, and we propose to estimate them by maximizing the likelihood function,
  $$\ell(\beta,\gamma)=-\frac{1}{2}\sum_{i=1}^{n}T_{i}(x_{i}'\beta)-\frac{1}{2}\sum_{i=1}^{n}\exp(-x_{i}'\beta)\gamma'S_{i}\gamma,$$
where \(S_{i}=\sum_{t=1}^{T_{i}}y_{it}y_{it}'\). To estimate \(\gamma\), we impose the following constraint
  $$\gamma' H\gamma=1,$$
where \(H\) is a positive definite matrix. In this study, we consider the choice that
  $$H=\bar{\Sigma}, \quad \bar{\Sigma}=\frac{1}{n}\sum_{i=1}^{n}\frac{1}{T_{i}}S_{i}.$$</p>
<p>For higher order projecting directions, an orthogonal constraint is imposed as well.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>When <code>method = "CAP"</code>,</p>
<dt>gamma</dt><dd><p>the estimate of \(\gamma\) vectors, which is a \(p\times nD\) matrix.</p></dd>
  <dt>beta</dt><dd><p>the estimate of \(\beta\) for each projecting direction, which is a \(q\times nD\) matrix, where \(q-1\) is the number of explanatory variables.</p></dd>
  <dt>orthogonality</dt><dd><p>an ad hoc checking of the orthogonality between \(\gamma\) vectors.</p></dd>
  <dt>DfD</dt><dd><p>output of both average (geometric mean) and individual level of ``deviation from diagonality''.</p></dd>
  <dt>score</dt><dd><p>an output when <code>score.return = TRUE</code>. A \(n\times nD\) matrix of \(\log(\hat{\gamma}'S_{i}\hat{\gamma})\) value.</p></dd>

  When method = "CAP-C",
    <dt>gamma</dt><dd><p>the estimate of \(\gamma\) vectors, which is a \(p\times nD\) matrix.</p></dd>
  <dt>beta</dt><dd><p>the estimate of \(\beta\) for each projecting direction, which is a \(q\times nD\) matrix, where \(q-1\) is the number of explanatory variables.</p></dd>
  <dt>orthogonality</dt><dd><p>an ad hoc checking of the orthogonality between \(\gamma\) vectors.</p></dd>
  <dt>PC.idx</dt><dd><p>a vector of length <code>nD</code>, the order index of identified \(\gamma\) vectors among all the common principal components.</p></dd>
  <dt>aPC.idx</dt><dd><p>the order index of all the principal components that satisfy the log-linear model and the eigenvalue condition.</p></dd>
  <dt>minmax</dt><dd><p>a logic output, whether the identified \(\gamma\) vectors are estimated from the minmax approach. If <code>FALSE</code>, indicating the eigenvalue condition is not satisfied for any principal component.</p></dd>
  <dt>score</dt><dd><p>an output when <code>score.return = TRUE</code>. A \(n\times nD\) matrix of \(\log(\hat{\gamma}'S_{i}\hat{\gamma})\) value.</p></dd>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Zhao et al. (2018) <em>Covariate Assisted Principal Regression for Covariance Matrix Outcomes</em> &lt;doi:10.1101/425033&gt;</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Yi Zhao, Johns Hopkins University, &lt;zhaoyi1026@gmail.com&gt;</p>
<p>Bingkai Wang, Johns Hopkins University, &lt;bwang51@jhmi.edu&gt;</p>
<p>Stewart Mostofsky, Johns Hopkins University, &lt;mostofsky@kennedykrieger.org&gt;</p>
<p>Brian Caffo, Johns Hopkins University, &lt;bcaffo@gmail.com&gt;</p>
<p>Xi Luo, Brown University, &lt;xi.rossi.luo@gmail.com&gt;</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <div class="ref-examples sourceCode"><pre class='sourceCode r'><code><span class='r-in'></span>
<span class='r-in'><span class='co'>#############################################</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>env.example</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>X</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/get.html'>get</a></span><span class='op'>(</span><span class='st'>"X"</span>,<span class='va'>env.example</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>Y</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/get.html'>get</a></span><span class='op'>(</span><span class='st'>"Y"</span>,<span class='va'>env.example</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># method = "CAP"</span></span>
<span class='r-in'><span class='co'># without orthogonal constraint</span></span>
<span class='r-in'><span class='va'>re1</span><span class='op'>&lt;-</span><span class='fu'>capReg</span><span class='op'>(</span><span class='va'>Y</span>,<span class='va'>X</span>,nD<span class='op'>=</span><span class='fl'>2</span>,method<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"CAP"</span><span class='op'>)</span>,CAP.OC<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span></span>
<span class='r-in'><span class='co'># with orthogonal constraint</span></span>
<span class='r-in'><span class='va'>re2</span><span class='op'>&lt;-</span><span class='fu'>capReg</span><span class='op'>(</span><span class='va'>Y</span>,<span class='va'>X</span>,nD<span class='op'>=</span><span class='fl'>2</span>,method<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"CAP"</span><span class='op'>)</span>,CAP.OC<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># method = "CAP-C"</span></span>
<span class='r-in'><span class='va'>re3</span><span class='op'>&lt;-</span><span class='fu'>capReg</span><span class='op'>(</span><span class='va'>Y</span>,<span class='va'>X</span>,nD<span class='op'>=</span><span class='fl'>2</span>,method<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"CAP-C"</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'><span class='co'>#############################################</span></span>
</code></pre></div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p><p>Developed by Yi Zhao.</p></p>
</div>

<div class="pkgdown">
  <p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.6.1.9001.</p></p>
</div>

      </footer>
   </div>

  


  

  </body>
</html>


